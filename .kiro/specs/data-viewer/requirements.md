# 需求文档: 数据可视化查看器

## 1. 概述

创建一个独立的Python脚本，用于可视化由 `data_collection2.py` 采集的数据。该工具应允许用户加载和浏览存储在 `xengym/data/obj/{object_name}` 目录下的数据，并提供对比和逐帧分析功能。

## 2. 功能需求

### 2.1. 数据加载
- **对象选择**: 应用程序启动时，应能自动检测 `xengym/data/obj/` 目录下的所有可用对象（例如 `circle_r4`），并允许用户通过下拉菜单或列表选择要加载的对象。
- **轨迹（Trj）选择**: 选择对象后，应加载该对象的所有轨迹（`trj_0`, `trj_1`, ...），并允许用户选择一个或多个轨迹进行可视化。
- **数据格式**: 工具需要能够读取使用 `pickle.load()` 反序列化的 `.pkl` 文件。

### 2.2. 用户界面 (UI)
- **主窗口**: 一个独立的窗口，用于显示所有可视化内容和控件。
- **控件面板**: 
  - 一个下拉菜单，用于选择要加载的**对象**。
  - 一个下拉菜单或列表，用于选择要显示的**轨迹**。
  - 复选框或开关，用于选择要显示的**传感器**（`sensor_0`, `sensor_1`）。
  - 一个标签，显示当前正在查看的**帧号**（frame）。
- **可视化区域**: 用于并排显示来自不同传感器和数据类型的图像和图表。

### 2.3. 可视化面板
对于每个选定的传感器（`sensor_0` 和/或 `sensor_1`），应显示以下数据：
- **图像数据**: 
  - `rectify_real` (BGR格式)
  - `diff_real` (BGR格式)
  - `depth_real` (BGR格式)
  - `rectify_sim` (RGB格式)
  - `diff_sim` (RGB格式)
  - `vis_depth_sim` (RGB格式)
- **节点坐标数据**:
  - `marker_real`: 在2D图表上绘制的插值后节点坐标。
  - `marker_of_real`: 在2D图表上绘制的原始节点坐标。
  - `marker_sim`: 在2D图表上绘制的仿真节点坐标。

### 2.4. 交互功能
- **传感器对比**: 用户可以选择同时显示 `sensor_0` 和 `sensor_1` 的数据，以便进行并排比较。
- **逐帧播放**: 
  - 按下**空格键**，加载并显示当前轨迹的下一帧数据。
  - 当到达轨迹的最后一帧时，循环回到第一帧或停止播放（需明确）。
- **窗口关闭**: 用户可以正常关闭应用程序窗口。

## 3. 技术要求

- **语言**: Python 3.9。
- **库**: 
  - `PyQt` 或 `tkinter` 用于GUI界面。
  - `pyqtgraph` 或 `matplotlib` 用于2D数据绘图。
  - `OpenCV (cv2)` 用于图像显示。
  - `numpy` 用于数据处理。
  - `pickle` 用于数据加载。
- **脚本位置**: 该工具应作为 `example/data_vis.py` 或类似的新文件创建，以保持项目结构的一致性。

## 4. 非功能性需求

- **性能**: 应用程序应能流畅地加载和显示图像及数据，帧切换不应有明显延迟。
- **易用性**: 界面应直观，用户无需阅读大量文档即可理解如何操作。
- **可扩展性**: 代码结构应清晰，以便将来可以轻松添加对其他数据类型或传感器的支持。
